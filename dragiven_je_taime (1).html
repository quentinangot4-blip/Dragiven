<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dragiven — Musique d'amour & Chat qui danse</title>
  <style>
    :root{--bg:#0b0712;--accent:#ff6b9a}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#fff;background:radial-gradient(ellipse at 20% 10%, #221129 0%, #08040a 40%, #020102 100%);}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}

    a.play-link{
      display:inline-block;padding:18px 28px;border-radius:999px;background:linear-gradient(90deg,#ff6b9a,#ffb3d0);color:#12020a;font-weight:900;text-decoration:none;font-size:20px;box-shadow:0 12px 30px rgba(255,120,160,0.12), 0 2px 0 rgba(0,0,0,0.25) inset;
    }

    /* overlay */
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:radial-gradient(circle at 50% 20%, rgba(255,120,160,0.08), rgba(0,0,0,0.6));z-index:50}
    .card{width:min(940px,92vw);max-width:1100px;padding:28px;border-radius:16px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.01));box-shadow:0 20px 60px rgba(0,0,0,0.6);display:flex;gap:20px;align-items:center;justify-content:space-between}

    /* dancing cat */
    .stage{width:420px;height:420px;position:relative;display:flex;align-items:center;justify-content:center}
    .cat{width:220px;height:240px;position:relative;display:flex;align-items:center;justify-content:center;flex-direction:column;transform-origin:center bottom}
    .cat .head{width:140px;height:120px;border-radius:60% 60% 50% 50%;background:linear-gradient(180deg,#ffdfe8,#ffc1d6);display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 10px 30px rgba(0,0,0,0.45)}
    .ear{position:absolute;top:-12px;width:34px;height:38px;background:#ff9ab3;border-radius:10px 10px 0 0;transform:rotate(-20deg);left:18px}
    .ear.right{left:auto;right:18px;transform:rotate(20deg)}
    .eye{width:12px;height:12px;background:#111;border-radius:50%;margin:0 10px}
    .mouth{width:60px;height:16px;border-radius:20px;background:#8b1b4a;margin-top:12px}
    .body{width:160px;height:120px;background:linear-gradient(180deg,#ffb3c6,#ff8aa7);border-radius:100px 100px 60px 60px;margin-top:6px;position:relative}
    .tail{position:absolute;right:-14px;bottom:20px;width:18px;height:110px;background:linear-gradient(180deg,#ff8aa7,#ff5d8f);border-radius:18px}

    /* hearts (CSS) */\    
    .hearts{position:absolute;left:50%;top:8%;transform:translateX(-50%);display:flex;gap:12px}
    .heart{width:36px;height:36px;position:relative;transform:scale(0);opacity:0}
    .heart:before,.heart:after{content:'';position:absolute;left:18px;top:0;width:18px;height:28px;background:#ff6b9a;border-radius:18px 18px 0 0;transform-origin:center bottom}
    .heart:before{left:0;transform:rotate(-45deg)}
    .heart:after{left:18px;transform:rotate(45deg)}
    .heart .inner{position:absolute;left:3px;top:6px;width:28px;height:28px;border-radius:50%;background:linear-gradient(180deg,#fff1f6,#ffb3cf);opacity:0.4}

    /* animation */
    @keyframes dance{0%{transform:translateY(0) rotate(-2deg)}25%{transform:translateY(-12px) rotate(8deg)}50%{transform:translateY(0) rotate(-2deg)}75%{transform:translateY(10px) rotate(8deg)}100%{transform:translateY(0) rotate(-2deg)}}
    @keyframes tailwag{0%{transform:rotate(10deg)}50%{transform:rotate(-40deg)}100%{transform:rotate(10deg)}}
    @keyframes heartPop{0%{transform:scale(0);opacity:0}40%{transform:scale(1.05);opacity:1}80%{transform:scale(0.9);opacity:0.7}100%{transform:translateY(-120px) scale(0.6);opacity:0}}

    .cat.dance{animation:dance 680ms ease-in-out infinite}
    .cat.dance .tail{animation:tailwag 420ms ease-in-out infinite}

    .heart.animate{animation:heartPop 1200ms ease-out forwards}

    /* text and controls */
    .info{flex:1;padding:8px 12px}
    .title{font-size:28px;font-weight:900;color:#fff;margin-bottom:8px}
    .subtitle{color:#ffd4e6;margin-bottom:12px}
    .actions{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,#ff8aa7,#ff5d8f);color:#100;font-weight:800}

    .close{background:transparent;color:#fff;border:2px solid rgba(255,255,255,0.06);padding:8px 12px}

    @media (max-width:820px){
      .card{flex-direction:column}
      .stage{width:320px;height:320px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <a href="#" id="playLink" class="play-link" role="button">Clique ici — Musique d'amour pour Dragiven ❤️</a>
  </div>

  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-label="Scène Dragiven">
      <div class="stage">
        <div class="hearts" id="hearts">
          <div class="heart"><div class="inner"></div></div>
          <div class="heart"><div class="inner"></div></div>
          <div class="heart"><div class="inner"></div></div>
        </div>

        <div class="cat" id="cat">
          <div class="head">
            <div class="ear"></div>
            <div class="ear right"></div>
            <div style="display:flex;flex-direction:column;align-items:center;">
              <div style="display:flex;align-items:center;justify-content:center">
                <div class="eye"></div>
                <div class="eye"></div>
              </div>
              <div class="mouth"></div>
            </div>
          </div>
          <div class="body"></div>
          <div class="tail"></div>
        </div>
      </div>

      <div class="info">
        <div class="title">Pour Dragiven — ❤️</div>
        <div class="subtitle">Le chat danse et des coeurs s'envolent pendant la musique.</div>
        <div class="actions">
          <button class="btn" id="stopBtn">Arrêter</button>
          <button class="btn" id="heartBtn">Lancer des coeurs</button>
          <button class="close" id="closeBtn">Fermer</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const playLink = document.getElementById('playLink');
    const overlay = document.getElementById('overlay');
    const cat = document.getElementById('cat');
    const hearts = document.getElementById('hearts');
    const stopBtn = document.getElementById('stopBtn');
    const heartBtn = document.getElementById('heartBtn');
    const closeBtn = document.getElementById('closeBtn');

    // simple WebAudio love melody + arpeggio
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let ctx, master;
    let isPlaying = false;
    let melodyInterval, arpegInterval;

    function createCtx(){
      if(!ctx){
        ctx = new AudioCtx();
        master = ctx.createGain(); master.gain.value = 0.6; master.connect(ctx.destination);
      }
    }

    function playNote(freq, time, duration=0.4, type='sine'){
      const o = ctx.createOscillator();
      const g = ctx.createGain();
      o.type = type; o.frequency.setValueAtTime(freq, time);
      g.gain.setValueAtTime(0.0001, time);
      g.gain.exponentialRampToValueAtTime(0.12, time+0.01);
      g.gain.exponentialRampToValueAtTime(0.0001, time+duration);
      o.connect(g); g.connect(master);
      o.start(time); o.stop(time+duration+0.02);
    }

    // degrees to freq helper (C4 = 261.63)
    function degreeToFreq(semitonesFromC4){ return 261.63 * Math.pow(2, semitonesFromC4/12); }

    function startMusic(){
      createCtx();
      if(ctx.state === 'suspended') ctx.resume();
      isPlaying = true;

      // simple love melody loop
      let idx = 0;
      const melody = [0, 2, 4, 5, 7, 9, 7, 5]; // semitone offsets
      melodyInterval = setInterval(()=>{
        const now = ctx.currentTime;
        const base = degreeToFreq(0 + 12); // higher octave C
        playNote(base * Math.pow(2, melody[idx]/12), now, 0.45, 'triangle');
        idx = (idx + 1) % melody.length;
      }, 480);

      // arpeggio chord
      const chord = [0,4,7];
      let ai = 0;
      arpegInterval = setInterval(()=>{
        const now = ctx.currentTime;
        const root = degreeToFreq(-5 + 12); // A-ish
        playNote(root * Math.pow(2,chord[ai%chord.length]/12), now, 0.32, 'sine');
        ai++;
      }, 160);

      // subtle bass thump
      const bass = setInterval(()=>{
        const o = ctx.createOscillator(); const g = ctx.createGain(); o.type='sine'; o.frequency.value=65;
        g.gain.value=0.0001; g.gain.exponentialRampToValueAtTime(0.18, ctx.currentTime+0.01); g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.4);
        o.connect(g); g.connect(master); o.start(); o.stop(ctx.currentTime+0.5);
      }, 960);

      // save bass id
      if(window._loveBass) clearInterval(window._loveBass);
      window._loveBass = bass;

      // animate cat
      cat.classList.add('dance');
    }

    function stopMusic(){
      isPlaying = false;
      if(melodyInterval) clearInterval(melodyInterval);
      if(arpegInterval) clearInterval(arpegInterval);
      if(window._loveBass) clearInterval(window._loveBass);
      if(ctx) master.gain.setTargetAtTime(0.0001, ctx.currentTime, 0.05);
      cat.classList.remove('dance');
    }

    function popHearts(){
      // add animation class to each .heart, staggered
      const hs = hearts.querySelectorAll('.heart');
      hs.forEach((h,i)=>{
        // restart animation
        h.classList.remove('animate');
        void h.offsetWidth;
        setTimeout(()=>h.classList.add('animate'), i*180);
      });
    }

    // click link to open overlay + start music
    playLink.addEventListener('click', (e)=>{
      e.preventDefault();
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden','false');
      // start audio on user gesture
      startMusic();
      popHearts();
    });

    stopBtn.addEventListener('click', ()=>{ stopMusic(); });
    heartBtn.addEventListener('click', ()=>{ popHearts(); });
    closeBtn.addEventListener('click', ()=>{ stopMusic(); overlay.style.display='none'; overlay.setAttribute('aria-hidden','true'); });

    // allow closing by escape
    window.addEventListener('keydown',(e)=>{ if(e.key==='Escape'){ closeBtn.click(); } });

    // Accessibility: ensure audio starts only after gesture (handled by click)
  </script>
</body>
</html>
